<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tournaments DApp</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <script defer src="./scripts/TournamentsStorage.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }

        input {
            display: block;
            margin: 10px auto;
            padding: 5px;
        }

        button {
            margin: 5px;
            padding: 8px 12px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <h1>Tournaments DApp</h1>

    <button onclick="getAllTournaments()">Get All Tournaments</button>

    <input type="number" id="tournamentId" placeholder="Tournament ID">
    <button onclick="fetchTournament()">Get Tournament</button>
    <button onclick="fetchParticipants()">Get Participants</button>
    <button onclick="fetchMatchedParticipants()">Get Matched Participants</button>
    <button onclick="fetchScores()">Get Scores</button>

    <input type="text" id="date" placeholder="Date (DDMMYYYY)">
    <input type="text" id="time" placeholder="Time (HHMM)">
    <button onclick="createNewTournament()">Create Tournament</button>

    <input type="text" id="tournamentId" placeholder="Tournament ID">
    <input type="text" id="participantName" placeholder="Participant Name">
    <button onclick="joinTournamentAction()">Join Tournament</button>

    <input type="text" id="tournamentId" placeholder="Tournament ID">
    <input type="text" id="winnerName" placeholder="Winner Name">
    <button onclick="addWinnerAction()">Add Winner</button>

    <input type="text" id="tournamentId" placeholder="Tournament ID">
    <input type="text" id="playerOneName" placeholder="Player One Name">
    <input type="text" id="playerOneScore" placeholder="Player One Score">
    <input type="text" id="playerTwoName" placeholder="Player Two Name">
    <input type="text" id="playerTwoScore" placeholder="Player Two Score">
    <button onclick="saveScoreAction()">saveScore</button>

    <script>
        async function fetchTournament() {
            const id = document.getElementById('tournamentId').value;
            if (id) {
                try {
                    await getTournament(parseInt(id));
                } catch (error) {
                    console.error("Error fetching tournament:", error);
                }
            } else {
                alert("Please enter a valid Tournament ID");
            }
        }

        async function fetchParticipants() {
            const id = document.getElementById('tournamentId').value;
            if (id) {
                try {
                    await getParticipants(parseInt(id));
                } catch (error) {
                    console.error("Error fetching participants:", error);
                }
            } else {
                alert("Please enter a valid Tournament ID");
            }
        }

        async function fetchMatchedParticipants() {
            const id = document.getElementById('tournamentId').value;
            if (id) {
                try {
                    await getMatchedParticipants(parseInt(id));
                } catch (error) {
                    console.error("Error fetching matched participants:", error);
                }
            } else {
                alert("Please enter a valid Tournament ID");
            }
        }

        async function fetchScores() {
            const id = document.getElementById('tournamentId').value;
            if (id) {
                try {
                    await getScores(parseInt(id));
                } catch (error) {
                    console.error("Error fetching scores:", error);
                }
            } else {
                alert("Please enter a valid Tournament ID");
            }
        }

        async function createNewTournament() {
            const date = document.getElementById('date').value;
            const time = document.getElementById('time').value;
            if (date && time) {
                try {
                    await createTournament(parseInt(date), parseInt(time));
                } catch (error) {
                    console.error("Error creating tournament:", error);
                }
            } else {
                alert("Please enter valid date and time");
            }
        }

        async function joinTournamentAction() {
            const id = document.getElementById('tournamentId').value;
            const name = document.getElementById('participantName').value;
            if (id && name) {
                try {
                    await joinTournament(parseInt(id), name);
                } catch (error) {
                    console.error("Error joining tournament:", error);
                }
            } else {
                alert("Please enter a valid Tournament ID and Participant Name");
            }
        }

        async function addWinnerAction() {
            const id = document.getElementById('tournamentId').value;
            const name = document.getElementById('winnerName').value;
            if (id && name) {
                try {
                    await addWinner(parseInt(id), name);
                } catch (error) {
                    console.error("Error adding winner:", error);
                }
            } else {
                alert("Please enter a valid Tournament ID and Participant Name");
            }
        }

        async function saveScoreAction() {
            const id = document.getElementById('tournamentId').value;
            const playerOneName = document.getElementById('playerOneName').value;
            const playerOneScore = document.getElementById('playerOneScore').value;
            const playerTwoName = document.getElementById('playerTwoName').value;
            const playerTwoScore = document.getElementById('playerTwoScore').value;
            if (id && playerOneName && playerOneScore && playerTwoName && playerTwoScore) {
                try {
                    await saveScore(parseInt(id), playerOneName, parseInt(playerOneScore), playerTwoName, parseInt(playerTwoScore));
                } catch (error) {
                    console.error("Error saving score:", error);
                }
            } else {
                alert("Please enter valid Tournament ID and Player details");
            }
        }
    </script>
</body>

</html>